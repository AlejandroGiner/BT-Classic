estate_btc_mamluks_land_rights = {
	icon = privilege_grant_autonomy
	land_share = 5
	max_absolutism = -5
	loyalty = 0.05
	influence = 0.05
	can_select = {
	}
	on_granted = {
	}
	penalties = {
	}
	benefits = {
		governing_capacity = 150
	}
	ai_will_do = {
		factor = 5
		modifier = {
			factor = 1.4
			num_of_territories = 5
		}
		modifier = {
			factor = 1.5
			num_of_territories = 10
		}
		modifier = {
			factor = 1.5
			num_of_territories = 15
		}
		modifier = {
			factor = 0
			OR = {
				NOT = { crown_land_share = 25 }
				estate_influence = {
					estate = estate_btc_mamluks
					influence = 75
				}
			}
			NOT = { has_estate_privilege = estate_btc_mamluks_land_rights }
		}
		modifier = {
			factor = 0
			NOT = { num_of_territories = 1 }
		}
		modifier = {
			factor = 0.8
			OR = {
				NOT = { crown_land_share = 40 }
				AND = {
					is_absolutism_active = yes
					NOT = { crown_land_share = 60 }
				}
			}
			NOT = { has_estate_privilege = estate_btc_mamluks_land_rights }
		}
		modifier = {
			factor = 0.8
			OR = {
				NOT = { crown_land_share = 30 }
				AND = {
					is_absolutism_active = yes
					NOT = { crown_land_share = 50 }
				}
			}
			NOT = { has_estate_privilege = estate_btc_mamluks_land_rights }
		}
		modifier = {
			factor = 0.8
			is_absolutism_active = yes
		}
	}
}

estate_btc_mamluks_mamluk_primacy = {
	icon = privilege_military_power
	land_share = 10
	max_absolutism = -5
	loyalty = -0.05
	can_select = {
		custom_trigger_tooltip = {
			tooltip = no_other_mil_privilege
			NOT = { has_estate_privilege = estate_rajput_military }
			NOT = { has_estate_privilege = estate_maratha_military }
			NOT = { has_estate_privilege = estate_nobles_nobility_primacy }
			NOT = { has_estate_privilege = estate_btc_janissaries_janissary_primacy }
			NOT = { has_estate_privilege = estate_btc_qizilbash_qizilbash_primacy }
		}
	}
	on_granted = {
	}
	penalties = {
	}
	benefits = {
		country_military_power = 1
	}
	ai_will_do = {
		factor = 12
		modifier = {
			factor = 0
			OR = {
				NOT = { crown_land_share = 30 }
				estate_influence = {
					estate = estate_nobles
					influence = 75
				}
			}
			NOT = { has_estate_privilege = estate_btc_mamluks_mamluk_primacy }
		}
		modifier = {
			factor = 0.8
			OR = {
				NOT = { crown_land_share = 35 }
				AND = {
					is_absolutism_active = yes
					NOT = { crown_land_share = 55 }
				}
			}
			NOT = { has_estate_privilege = estate_btc_mamluks_mamluk_primacy }
		}
		modifier = {
			factor = 0.8
			is_absolutism_active = yes
		}
		modifier = {
			factor = 1.25
			NOT = { mil = 2 }
		}
		modifier = {
			factor = 0.8
			mil = 5
		}
	}
}

estate_btc_mamluks_autonomy = {
	icon = privilege_mamluks_autonomy
	max_absolutism = -10
	loyalty = 0.1
	influence = 0.1
	penalties = {
	}
	benefits = {
	}
	ai_will_do = {
		factor = 10
		modifier = {
			factor = 0
			is_absolutism_active = yes
		}
	}
}

estate_btc_mamluks_promote_leadership = {
	icon = privilege_mamluks_promote_leadership
	max_absolutism = -5
	influence = 0.1
	penalties = {
		yearly_corruption = 0.05
		nobles_influence_modifier = -0.05
	}
	benefits = {
		leader_land_shock = 1
		movement_speed = 0.1
		#Also unlocks access to special military advisor Khassaki Commander (+20% CCA)
	}
	on_granted = {
		custom_tooltip = estate_btc_mamluks_promote_leadership_effect_tooltip
	}
	on_revoked = {
		custom_tooltip = estate_btc_mamluks_promote_leadership_revoke_effect_tooltip
	}
	ai_will_do = {
		factor = 10
		modifier = {
			factor = 0
			is_absolutism_active = yes
		}
	}
}

estate_btc_mamluks_reduce_army_independence = {
	icon = privilege_mamluks_reduce_army_independence
	max_absolutism = 0
	loyalty = -0.15
	influence = -0.05
	penalties = {
		reinforce_speed = -0.25
		cavalry_power = -0.1
	}
	benefits = {
		yearly_corruption = -0.05
		army_tradition = 1
	}
	on_granted = {
		add_yearly_manpower = 1
		add_army_tradition = 10
		add_estate_loyalty = {
			estate = estate_btc_mamluks
			loyalty = -30
		}
	}
	ai_will_do = {
		factor = 0
	}
}

estate_btc_mamluks_red_sea_trading_posts = {
	icon = privilege_comission_merchant_ships_for_war
	max_absolutism = -5
	loyalty = 0.1
	influence = 0.05
	penalties = {
		burghers_loyalty_modifier = -0.05
	}
	benefits = {
	}
	on_granted = {
		add_mercantilism = 3
		custom_tooltip = btc_mamluks_red_sea_trading_posts_tooltip
		#-35% dev cost and +40 autonomy floor to Red Sea coastal provinces
		hidden_effect = {
			every_owned_province = {
				limit = {
					sea_zone = {
						area = red_sea_area
					}
				}
				add_province_modifier = {
					name = estate_mamluks_red_sea_ports_mod
					duration = -1
				}
			}
		}
	}
	on_revoked = {
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = estate_mamluks_red_sea_ports_mod }
				remove_province_modifier = estate_mamluks_red_sea_ports_mod
			}
		}
	}
	on_invalid = {
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = estate_mamluks_red_sea_ports_mod }
				remove_province_modifier = estate_mamluks_red_sea_ports_mod
			}
		}
	}
	ai_will_do = {
		factor = 0
	}
}

estate_btc_mamluks_sudan_somalia_raids = {
	icon = privilege_mamluks_sudan_somalia_raids
	max_absolutism = -5
	loyalty = 0.05
	influence = 0
	penalties = {
		yearly_corruption = 0.1
	}
	benefits = {
		global_tax_income = 24 #yearly
	}
	on_granted = {
		custom_tooltip = btc_mamluks_somali_raids_tooltip
		# TODO
		#A bunch of sailors (from Somalia), manpower and ducats
		#Reduces opinion of any nation owning provinces in the affected areas
		#Also adds devastation to the affected provinces
	}
	ai_will_do = {
		factor = 0
	}
}

estate_btc_mamluks_rotate_palace_guard = {
	icon = privilege_mamluks_rotate_palace_guard
	max_absolutism = 0
	loyalty = -0.1
	influence = 0.05
	penalties = {
	}
	benefits = {
		stability_cost_modifier = -0.25
		land_maintenance_modifier = 0.05
	}
	on_granted = {
		add_stability_or_adm_power = yes
	}
	ai_will_do = {
		factor = 0
	}
}

estate_btc_mamluks_relax_ownership_laws = {
	icon = privilege_monopoly_of_goods_livestock
	max_absolutism = -5
	influence = 0.05
	loyalty = 0.1
	land_share = 10
	is_valid = {
		any_owned_province = {
			OR = {
				trade_goods = grain
				trade_goods = cotton
				trade_goods = livestock
			}
		}
	}
	on_granted = {
		custom_tooltip = estate_mamluks_relax_ownership_tooltip
		hidden_effect = {
			every_owned_province = {
				limit = {
					OR = {
						trade_goods = grain
						trade_goods = cotton
						trade_goods = livestock
					}
				}
				add_province_modifier = {
					name = estate_mamluks_relax_ownership_mod
					duration = -1
				}
			}
		}
	}
	on_revoked = {
		custom_tooltip = estate_mamluks_relax_ownership_mod_revoke_tooltip
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = estate_mamluks_relax_ownership_mod }
				remove_province_modifier = estate_mamluks_relax_ownership_mod
			}
		}
	}
	on_invalid = {
		custom_tooltip = estate_mamluks_relax_ownership_mod_revoke_tooltip
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = estate_mamluks_relax_ownership_mod }
				remove_province_modifier = estate_mamluks_relax_ownership_mod
			}
		}
	}
	penalties = {
		# -10% peasantry loyalty
	}
	benefits = {
		yearly_corruption = -0.1
	}
	ai_will_do = {
		factor = 0
	}
}

estate_btc_mamluks_enforce_recruitment_levant = {
	icon = privilege_demand_more_troops
	max_absolutism = -5
	loyalty = 0.05
	influence = 0.05
	land_share = 5
	is_valid = {
		any_owned_province = {
			culture = al_suryah_arabic
			religion_group = muslim
			OR = {
				region = mashriq_region
				area = rakka_area
			}
		}
	}
	penalties = {
	}
	benefits = {
	}
	on_granted = {
		custom_tooltip = btc_mamluks_force_recruitment_levant_tooltip
		hidden_effect = {
			every_owned_province = {
				limit = {
					culture = al_suryah_arabic
					religion_group = muslim
					OR = {
						region = mashriq_region
						area = rakka_area
					}
				}
				add_province_modifier = {
					name = estate_mamluks_forced_recruitment_mod
					duration = -1
				}
			}
		}
	}
	on_revoked = {
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = estate_mamluks_forced_recruitment_mod }
				remove_province_modifier = estate_mamluks_forced_recruitment_mod
			}
		}
	}
	on_invalid = {
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = estate_mamluks_forced_recruitment_mod }
				remove_province_modifier = estate_mamluks_forced_recruitment_mod
			}
		}
	}
}

estate_btc_mamluks_entrenched_syrian_governors = {
	icon = privilege_mamluks_entrenched_syrian_governors
	max_absolutism = -10
	loyalty = 0
	influence = 0.15
	is_valid = {
		any_owned_province = {
			region = mashriq_region
			NOT = { area = syrian_desert_area }
		}
	}
	penalties = {
		yearly_corruption = 0.1
		nobles_loyalty_modifier = -0.05
	}
	benefits = {
	}
	on_granted = {
		custom_tooltip = estate_btc_mamluks_entrenched_syrian_governors_tooltip
		hidden_effect = {
			every_owned_province = {
				limit = {
					region = mashriq_region
					NOT = { area = syrian_desert_area }
				}
				add_province_modifier = {
					name = estate_mamluks_entrenched_syrian_governors_mod
					duration = -1
				}
			}
		}
	}
	on_revoked = {
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = estate_mamluks_entrenched_syrian_governors_mod }
				remove_province_modifier = estate_mamluks_entrenched_syrian_governors_mod
			}
		}
		# TODO
		#The privilege has a tooltip that says "If this privilege is revoked, the governor and his guard will return to Egypt, likely causing trouble" 
		#After a year or 2 of revoking the privilege, you get a big revolt in Egypt of Mamluk rebels
	}
	on_invalid = {
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = estate_mamluks_entrenched_syrian_governors_mod }
				remove_province_modifier = estate_mamluks_entrenched_syrian_governors_mod
			}
		}
	}
	ai_will_do = {
		factor = 0
	}
}
